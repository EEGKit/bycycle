<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3. Cycle-by-cycle analysis of resting state data &#8212; bycycle 1.0.0rc2 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172123592-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172123592-1');
</script>


  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/logo.jpg"></span>
          bycycle</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.0rc2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../glossary.html">Glossary</a></li>
                <li><a href="index.html">Tutorial</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="https://github.com/bycycle-tools/bycycle">GitHub</a></li>
            
            
  <li class="dropdown">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown" style="margin-left: 10px">
    v1.0.0rc2
    <span class="caret"></span>
  </button>
    <ul class="dropdown-menu" aria-labelledby="dLabelMore">
      <li><a href="https://bycycle-tools.github.io/bycycle/v1.0.0rc2/index.html">v1.0.0rc2</a></li>
      <li><a href="https://bycycle-tools.github.io/bycycle/index.html">v0.1.3(stable)</a></li>
    </ul>
  </li>

            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-plot-3-bycycle-resting-state-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="cycle-by-cycle-analysis-of-resting-state-data">
<span id="sphx-glr-auto-tutorials-plot-3-bycycle-resting-state-py"></span><h1>3. Cycle-by-cycle analysis of resting state data<a class="headerlink" href="#cycle-by-cycle-analysis-of-resting-state-data" title="Permalink to this headline">¶</a></h1>
<p>Simulated experiment using the cycle-by-cycle approach.</p>
<p>Say we ran an experiment and want to compare subjects’ resting state data for some reason. Maybe we
want to study age, gender, disease state, or something. This has often been done to study
differences in oscillatory power or coupling between groups of people. In this notebook, we will run
through how to use bycycle to analyze resting state data.</p>
<p>In this example, we have 20 subjects (10 patients, 10 control), and we for some reason hypothesized
that their alpha oscillations may be systematically different. For example, (excessive hand waving)
we think the patient group should have more top-down input that increases the synchrony in the
oscillatory input (measured by its symmetry).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">neurodsp.sim</span> <span class="kn">import</span> <a href="https://neurodsp-tools.github.io/neurodsp/generated/neurodsp.sim.sim_combined.html#neurodsp.sim.sim_combined" title="neurodsp.sim.sim_combined" class="sphx-glr-backref-module-neurodsp-sim sphx-glr-backref-type-py-function"><span class="n">sim_combined</span></a>
<span class="kn">from</span> <span class="nn">neurodsp.filt</span> <span class="kn">import</span> <a href="https://neurodsp-tools.github.io/neurodsp/generated/neurodsp.filt.filter_signal.html#neurodsp.filt.filter_signal" title="neurodsp.filt.filter_signal" class="sphx-glr-backref-module-neurodsp-filt sphx-glr-backref-type-py-function"><span class="n">filter_signal</span></a>
<span class="kn">from</span> <span class="nn">neurodsp.plts</span> <span class="kn">import</span> <a href="https://neurodsp-tools.github.io/neurodsp/generated/neurodsp.plts.plot_time_series.html#neurodsp.plts.plot_time_series" title="neurodsp.plts.plot_time_series" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_time_series</span></a>

<span class="kn">from</span> <span class="nn">bycycle.group</span> <span class="kn">import</span> <a href="../generated/bycycle.group.compute_features_2d.html#bycycle.group.compute_features_2d" title="bycycle.group.compute_features_2d" class="sphx-glr-backref-module-bycycle-group sphx-glr-backref-type-py-function"><span class="n">compute_features_2d</span></a>
<span class="kn">from</span> <span class="nn">bycycle.plts</span> <span class="kn">import</span> <a href="../generated/bycycle.plts.plot_burst_detect_summary.html#bycycle.plts.plot_burst_detect_summary" title="bycycle.plts.plot_burst_detect_summary" class="sphx-glr-backref-module-bycycle-plts sphx-glr-backref-type-py-function"><span class="n">plot_burst_detect_summary</span></a><span class="p">,</span> <a href="../generated/bycycle.plts.plot_feature_categorical.html#bycycle.plts.plot_feature_categorical" title="bycycle.plts.plot_feature_categorical" class="sphx-glr-backref-module-bycycle-plts sphx-glr-backref-type-py-function"><span class="n">plot_feature_categorical</span></a>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
<div class="section" id="load-simulated-experiment-of-10-patients-and-10-controls">
<h2>Load simulated experiment of 10 patients and 10 controls<a class="headerlink" href="#load-simulated-experiment-of-10-patients-and-10-controls" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate experimental data</span>
<span class="n">n_seconds</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_subjects</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">sigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_subjects</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="n">n_seconds</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">subject_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_subjects</span><span class="p">):</span>

    <span class="c1"># Manipulate the rise-decay symmetry between the two groups</span>
    <span class="n">rdsym</span> <span class="o">=</span> <span class="o">.</span><span class="mi">35</span> <span class="k">if</span> <span class="n">subject_idx</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.5</span>

    <span class="n">components</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sim_bursty_oscillation&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;enter_burst&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;leave_burst&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span>
                                             <span class="s1">&#39;cycle&#39;</span><span class="p">:</span> <span class="s1">&#39;asine&#39;</span><span class="p">,</span> <span class="s1">&#39;rdsym&#39;</span><span class="p">:</span> <span class="n">rdsym</span><span class="p">},</span>
                  <span class="s1">&#39;sim_powerlaw&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;f_range&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)}}</span>

    <span class="n">sigs</span><span class="p">[</span><span class="n">subject_idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://neurodsp-tools.github.io/neurodsp/generated/neurodsp.sim.sim_combined.html#neurodsp.sim.sim_combined" title="neurodsp.sim.sim_combined" class="sphx-glr-backref-module-neurodsp-sim sphx-glr-backref-type-py-function"><span class="n">sim_combined</span></a><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span> <span class="n">component_variances</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


<span class="c1"># Apply lowpass filter to each signal</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sigs</span><span class="p">)):</span>
    <span class="n">sigs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://neurodsp-tools.github.io/neurodsp/generated/neurodsp.filt.filter_signal.html#neurodsp.filt.filter_signal" title="neurodsp.filt.filter_signal" class="sphx-glr-backref-module-neurodsp-filt sphx-glr-backref-type-py-function"><span class="n">filter_signal</span></a><span class="p">(</span><span class="n">sigs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">fs</span><span class="p">,</span> <span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">n_seconds</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">remove_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot an example signal</span>
<span class="n">n_signals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigs</span><span class="p">)</span>
<span class="n">n_seconds</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">fs</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

<a href="https://neurodsp-tools.github.io/neurodsp/generated/neurodsp.plts.plot_time_series.html#neurodsp.plts.plot_time_series" title="neurodsp.plts.plot_time_series" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_time_series</span></a><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">sigs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot 3 bycycle resting state" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_3_bycycle_resting_state_001.png" />
</div>
<div class="section" id="compute-cycle-by-cycle-features">
<h2>Compute cycle-by-cycle features<a class="headerlink" href="#compute-cycle-by-cycle-features" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frequency band of interest</span>
<span class="n">f_alpha</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

<span class="c1"># Tuned burst detection parameters</span>
<span class="n">threshold_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;amp_fraction_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span>
                    <span class="s1">&#39;amp_consistency_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span>
                    <span class="s1">&#39;period_consistency_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span>
                    <span class="s1">&#39;monotonicity_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span>
                    <span class="s1">&#39;min_n_cycles&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="c1"># Compute features for each signal</span>
<span class="n">compute_features_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;threshold_kwargs&#39;</span><span class="p">:</span> <span class="n">threshold_kwargs</span><span class="p">}</span>

<span class="n">df_features_list</span> <span class="o">=</span> <a href="../generated/bycycle.group.compute_features_2d.html#bycycle.group.compute_features_2d" title="bycycle.group.compute_features_2d" class="sphx-glr-backref-module-bycycle-group sphx-glr-backref-type-py-function"><span class="n">compute_features_2d</span></a><span class="p">(</span><span class="n">sigs</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">f_alpha</span><span class="p">,</span> <span class="n">compute_features_kwargs</span><span class="p">)</span>

<span class="c1"># Add group and subject ids to dataframes</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;patient&#39;</span> <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_signals</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;control&#39;</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_signals</span><span class="p">)]</span>
<span class="n">subject_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_signals</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
    <span class="n">df_features_list</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span>
    <span class="n">df_features_list</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s1">&#39;subject_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject_ids</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="c1"># Concatenate the list of dataframes</span>
<span class="n">df_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_features_list</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>amp_fraction</th>
      <th>amp_consistency</th>
      <th>period_consistency</th>
      <th>monotonicity</th>
      <th>period</th>
      <th>...</th>
      <th>sample_last_trough</th>
      <th>sample_next_trough</th>
      <th>is_burst</th>
      <th>group</th>
      <th>subject_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.548387</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.909836</td>
      <td>90</td>
      <td>...</td>
      <td>90</td>
      <td>180</td>
      <td>False</td>
      <td>control</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.946237</td>
      <td>0.443796</td>
      <td>0.891089</td>
      <td>1.000000</td>
      <td>101</td>
      <td>...</td>
      <td>180</td>
      <td>281</td>
      <td>False</td>
      <td>control</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.903226</td>
      <td>0.811439</td>
      <td>0.925234</td>
      <td>1.000000</td>
      <td>99</td>
      <td>...</td>
      <td>281</td>
      <td>380</td>
      <td>True</td>
      <td>control</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.849462</td>
      <td>0.714068</td>
      <td>0.869159</td>
      <td>1.000000</td>
      <td>107</td>
      <td>...</td>
      <td>380</td>
      <td>487</td>
      <td>True</td>
      <td>control</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.741935</td>
      <td>0.563937</td>
      <td>0.869159</td>
      <td>1.000000</td>
      <td>93</td>
      <td>...</td>
      <td>487</td>
      <td>580</td>
      <td>True</td>
      <td>control</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
<br />
<br /></div>
<div class="section" id="confirm-appropriateness-of-burst-detection-parameters">
<h2>Confirm appropriateness of burst detection parameters<a class="headerlink" href="#confirm-appropriateness-of-burst-detection-parameters" title="Permalink to this headline">¶</a></h2>
<p>These burst detection parameters seem appropriate because they mostly restrict the analysis to
periods of the signal that appear to be bursting. This was confirmed by looking at a few different
signal segments from a few subjects.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/bycycle.plts.plot_burst_detect_summary.html#bycycle.plts.plot_burst_detect_summary" title="bycycle.plts.plot_burst_detect_summary" class="sphx-glr-backref-module-bycycle-plts sphx-glr-backref-type-py-function"><span class="n">plot_burst_detect_summary</span></a><span class="p">(</span><span class="n">df_features_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fs</span><span class="p">,</span> <span class="n">threshold_kwargs</span><span class="p">,</span>
                          <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="plot 3 bycycle resting state" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_3_bycycle_resting_state_002.png" />
</div>
<div class="section" id="analyze-cycle-by-cycle-features">
<h2>Analyze cycle-by-cycle features<a class="headerlink" href="#analyze-cycle-by-cycle-features" title="Permalink to this headline">¶</a></h2>
<p>Note the significant difference between the treatment and control groups for rise-decay symmetry
but not the other features</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Only consider cycles that were identified to be in bursting regimes</span>
<span class="n">df_features_burst</span> <span class="o">=</span> <span class="n">df_features</span><span class="p">[</span><span class="n">df_features</span><span class="p">[</span><span class="s1">&#39;is_burst&#39;</span><span class="p">]]</span>

<span class="c1"># Compute average features across subjects in a recording</span>
<span class="n">features_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;volt_amp&#39;</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="s1">&#39;time_rdsym&#39;</span><span class="p">,</span> <span class="s1">&#39;time_ptsym&#39;</span><span class="p">]</span>
<span class="n">df_subjects</span> <span class="o">=</span> <span class="n">df_features_burst</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="n">features_keep</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_subjects</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>subject_id</th>
      <th>volt_amp</th>
      <th>period</th>
      <th>time_rdsym</th>
      <th>time_ptsym</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>control</td>
      <td>0</td>
      <td>3.277758</td>
      <td>105.227273</td>
      <td>0.438809</td>
      <td>0.504641</td>
    </tr>
    <tr>
      <th>1</th>
      <td>control</td>
      <td>1</td>
      <td>3.217761</td>
      <td>101.095238</td>
      <td>0.409837</td>
      <td>0.518126</td>
    </tr>
    <tr>
      <th>2</th>
      <td>control</td>
      <td>2</td>
      <td>3.253245</td>
      <td>103.290323</td>
      <td>0.427419</td>
      <td>0.486417</td>
    </tr>
    <tr>
      <th>3</th>
      <td>control</td>
      <td>3</td>
      <td>3.589437</td>
      <td>100.652174</td>
      <td>0.463930</td>
      <td>0.513216</td>
    </tr>
    <tr>
      <th>4</th>
      <td>control</td>
      <td>4</td>
      <td>3.387054</td>
      <td>100.826087</td>
      <td>0.460605</td>
      <td>0.483475</td>
    </tr>
    <tr>
      <th>5</th>
      <td>control</td>
      <td>5</td>
      <td>2.756935</td>
      <td>99.678571</td>
      <td>0.457856</td>
      <td>0.481557</td>
    </tr>
    <tr>
      <th>6</th>
      <td>control</td>
      <td>6</td>
      <td>3.336927</td>
      <td>98.259259</td>
      <td>0.417835</td>
      <td>0.521222</td>
    </tr>
    <tr>
      <th>7</th>
      <td>control</td>
      <td>7</td>
      <td>3.846811</td>
      <td>99.333333</td>
      <td>0.416673</td>
      <td>0.519420</td>
    </tr>
    <tr>
      <th>8</th>
      <td>control</td>
      <td>8</td>
      <td>3.180790</td>
      <td>102.960000</td>
      <td>0.453527</td>
      <td>0.519813</td>
    </tr>
    <tr>
      <th>9</th>
      <td>control</td>
      <td>9</td>
      <td>3.214885</td>
      <td>101.342857</td>
      <td>0.438881</td>
      <td>0.504815</td>
    </tr>
    <tr>
      <th>10</th>
      <td>patient</td>
      <td>10</td>
      <td>3.349150</td>
      <td>103.593750</td>
      <td>0.426711</td>
      <td>0.502568</td>
    </tr>
    <tr>
      <th>11</th>
      <td>patient</td>
      <td>11</td>
      <td>3.548624</td>
      <td>102.166667</td>
      <td>0.511711</td>
      <td>0.519504</td>
    </tr>
    <tr>
      <th>12</th>
      <td>patient</td>
      <td>12</td>
      <td>3.503248</td>
      <td>99.166667</td>
      <td>0.507697</td>
      <td>0.519776</td>
    </tr>
    <tr>
      <th>13</th>
      <td>patient</td>
      <td>13</td>
      <td>3.743171</td>
      <td>100.363636</td>
      <td>0.493444</td>
      <td>0.501593</td>
    </tr>
    <tr>
      <th>14</th>
      <td>patient</td>
      <td>14</td>
      <td>3.609651</td>
      <td>102.285714</td>
      <td>0.513813</td>
      <td>0.500261</td>
    </tr>
    <tr>
      <th>15</th>
      <td>patient</td>
      <td>15</td>
      <td>3.407456</td>
      <td>104.736842</td>
      <td>0.496203</td>
      <td>0.481862</td>
    </tr>
    <tr>
      <th>16</th>
      <td>patient</td>
      <td>16</td>
      <td>3.339483</td>
      <td>102.310345</td>
      <td>0.514144</td>
      <td>0.491268</td>
    </tr>
    <tr>
      <th>17</th>
      <td>patient</td>
      <td>17</td>
      <td>3.371646</td>
      <td>103.375000</td>
      <td>0.462617</td>
      <td>0.497757</td>
    </tr>
    <tr>
      <th>18</th>
      <td>patient</td>
      <td>18</td>
      <td>3.240479</td>
      <td>100.775000</td>
      <td>0.496923</td>
      <td>0.493802</td>
    </tr>
    <tr>
      <th>19</th>
      <td>patient</td>
      <td>19</td>
      <td>3.137848</td>
      <td>95.944444</td>
      <td>0.482799</td>
      <td>0.472751</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<a href="../generated/bycycle.plts.plot_feature_categorical.html#bycycle.plts.plot_feature_categorical" title="bycycle.plts.plot_feature_categorical" class="sphx-glr-backref-module-bycycle-plts sphx-glr-backref-type-py-function"><span class="n">plot_feature_categorical</span></a><span class="p">(</span><span class="n">df_subjects</span><span class="p">,</span> <span class="s1">&#39;volt_amp&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">xlabel</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Patient&#39;</span><span class="p">,</span> <span class="s1">&#39;Control&#39;</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>

<a href="../generated/bycycle.plts.plot_feature_categorical.html#bycycle.plts.plot_feature_categorical" title="bycycle.plts.plot_feature_categorical" class="sphx-glr-backref-module-bycycle-plts sphx-glr-backref-type-py-function"><span class="n">plot_feature_categorical</span></a><span class="p">(</span><span class="n">df_subjects</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">xlabel</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Patient&#39;</span><span class="p">,</span> <span class="s1">&#39;Control&#39;</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Period (ms)&#39;</span><span class="p">)</span>

<a href="../generated/bycycle.plts.plot_feature_categorical.html#bycycle.plts.plot_feature_categorical" title="bycycle.plts.plot_feature_categorical" class="sphx-glr-backref-module-bycycle-plts sphx-glr-backref-type-py-function"><span class="n">plot_feature_categorical</span></a><span class="p">(</span><span class="n">df_subjects</span><span class="p">,</span> <span class="s1">&#39;time_rdsym&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">xlabel</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Patient&#39;</span><span class="p">,</span> <span class="s1">&#39;Control&#39;</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Rise-Decay Symmetry&#39;</span><span class="p">)</span>

<a href="../generated/bycycle.plts.plot_feature_categorical.html#bycycle.plts.plot_feature_categorical" title="bycycle.plts.plot_feature_categorical" class="sphx-glr-backref-module-bycycle-plts sphx-glr-backref-type-py-function"><span class="n">plot_feature_categorical</span></a><span class="p">(</span><span class="n">df_subjects</span><span class="p">,</span> <span class="s1">&#39;time_ptsym&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">xlabel</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Patient&#39;</span><span class="p">,</span> <span class="s1">&#39;Control&#39;</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Peak-Trough Symmetry&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot 3 bycycle resting state" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_3_bycycle_resting_state_003.png" />
</div>
<div class="section" id="statistical-differences-in-cycle-features">
<h2>Statistical differences in cycle features<a class="headerlink" href="#statistical-differences-in-cycle-features" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">feature_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;volt_amp&#39;</span><span class="p">:</span> <span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="s1">&#39;Period (ms)&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;time_rdsym&#39;</span><span class="p">:</span> <span class="s1">&#39;Rise-Decay Symmetry&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;time_ptsym&#39;</span><span class="p">:</span> <span class="s1">&#39;Peak-Trough Symmetry&#39;</span><span class="p">}</span>

<span class="k">for</span> <span class="n">feat</span><span class="p">,</span> <span class="n">feat_name</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="n">x_treatment</span> <span class="o">=</span> <span class="n">df_subjects</span><span class="p">[</span><span class="n">df_subjects</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;patient&#39;</span><span class="p">][</span><span class="n">feat</span><span class="p">]</span>
    <span class="n">x_control</span> <span class="o">=</span> <span class="n">df_subjects</span><span class="p">[</span><span class="n">df_subjects</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;control&#39;</span><span class="p">][</span><span class="n">feat</span><span class="p">]</span>
    <span class="n">ustat</span><span class="p">,</span> <span class="n">pval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">x_treatment</span><span class="p">,</span> <span class="n">x_control</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20s}</span><span class="s1"> difference between groups, U= </span><span class="si">{:3.0f}</span><span class="s1">, p=</span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">feat_name</span><span class="p">,</span> <span class="n">ustat</span><span class="p">,</span> <span class="n">pval</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rph/Projects/bycycle/.env/lib/python3.8/site-packages/scipy/stats/stats.py:7012: DeprecationWarning: Calling `mannwhitneyu` without specifying `alternative` is deprecated.
  warnings.warn(&quot;Calling `mannwhitneyu` without specifying &quot;
Amplitude            difference between groups, U=  32, p=0.09294
Period (ms)          difference between groups, U=  44, p=0.33879
Rise-Decay Symmetry  difference between groups, U=   8, p=0.00085
Peak-Trough Symmetry difference between groups, U=  35, p=0.13652
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.948 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-plot-3-bycycle-resting-state-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a420da27baa2092e3a432c04209f31d2/plot_3_bycycle_resting_state.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_3_bycycle_resting_state.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/be3ea6df6caa91fd553576917b156a88/plot_3_bycycle_resting_state.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_3_bycycle_resting_state.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018-2020, VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>